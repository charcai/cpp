# CSP-S 模拟赛

2023年8月1日

| 题目名称 | 移球游戏                   | 派对                        | 树染色                     | 随机操作                   |
| -------- | -------------------------- | --------------------------- | -------------------------- | -------------------------- |
| 文件名   | ball ( .cpp / .in / .out ) | party ( .cpp / .in / .out ) | tree ( .cpp / .in / .out ) | rand ( .cpp / .in / .out ) |
| 时间限制 | 1s                         | 1s                          | 2s                         | 2s                         |
| 空间限制 | 256mb                      | 256mb                       | 512mb                      | 1024mb                     |

# 移球游戏

## ball ( .cpp / .in / .out )

### 题目描述

有$n$个球排成一排，编号从左到右为$1,2,3,4,...,n$，其中第$i$个球的颜色为$a_i$。

你可以进行以下操作任意多次：

- 选择**两个**颜色相同的球，然后删除这两个球之间的所有球（包含选择的这两个球）

你想知道最多可以删除多少球。

有多组测试数据。

### 输入格式

第一行一个整数$T$表示测试数据组数。

接下来输入$T$组数据，每组数据包含两行：

- 第一行一个整数$n$。
- 第二行$n$个整数，$a_1,a_2,a_3,...,a_n$。

### 输出格式

输出$T$行，其中第$i$行表示第$i$组测试数据的答案。

### 样例输入

```
2
5
1 2 2 3 3
4
1 2 1 2
```

### 样例输出

```
4
3
```

### 数据范围

对于$10\%$的数据，满足$\sum n\leq 20$。

对于$40\%$的数据，满足$\sum n\leq 2000$。

对于另外$20\%$的数据，满足$a_i\in\set{1,2}$。

对于所有数据，满足$\sum n\leq 2\cdot 10^5,1\leq a_i\leq n$。

$\sum n$表示所有测试数据中$n$的总和。

# 派对

## party ( .cpp / .in / .out )

### 题目描述

有$n$个朋友，编号为$1,2,3,...,n$。

他们会举行若干场派对，每一场派对会选择若干人，然后进行若干分钟。

但是有一些限制:

1. $1$号朋友必须参加所有派对

2. $n$号朋友身体不好，所以不能参加任何一场派对

3. 有$m$条限制$(u_1,v_1,x_1),(u_2,v_2,x_2),...,(u_m,v_m,x_m)$。

   对于$(u_i,v_i,x_i)$需要满足：假设$y$为$u_i,v_i$中**恰好**一人在派对中的时间（也就是派对总时间$-($两人都在$+$两人都不在$)$），需要满足$y\leq x_i$。

你想要知道派对的总时长最长能是多少。

### 输入格式

第一行两个整数$n,m$。

接下来$m$行，其中第$i$行三个整数表示$u_i,v_i,x_i$。

### 输出格式

第一行两个整数$T,k$，表示总时长，与派对举行的场数。

**你需要保证输出的$k\leq n^2$。**

接下来$k$行，描述了$k$场派对。

其中第$i$行为一个长度为$n$的$01$串$s$与一个**非负**整数$t$，其中$s_j=1$当且仅当第$j$个人参加了第$i$场派对，这场派对持续的总时长为$t$。

特殊的，如果$T$可以是任意大的数，输出"inf"。

### 样例输入1

```
5 4
1 3 2
1 4 2
2 3 1
2 5 1
```

### 样例输出1

```
4 4
10000 1
10010 1
10100 1
11110 1
```

### 样例输入2

```
3 0
```

### 样例输出2

```
inf
```

### 数据范围

对于$20\%$的数据，满足$m\leq 10$。

对于另外$20\%$的数据，满足$u_i=1$。

对于$100\%$的数据，满足$2\leq n\leq 100,0\leq m\leq \frac{n(n-1)}{2},1\leq u_i<v_i\leq n,0\leq y_i\leq 10^9$。保证对于$i\neq j,(u_i,v_i)\neq (u_j,v_j)$。

# 树染色

## tree ( .cpp / .in / .out )

### 题目描述

有一个$n$个点的树。

你需要对于所有$0\leq k\leq n$，算出以下问题的答案：

你需要标记$k$个点，然后每条边会有一个代价，一条边的代价为两边被标记的点数差的绝对值。你需要知道，所有边的代价总和最大是多少。

### 输入格式

第一行一个整数$n$，表示树的点数。

接下来$n-1$行，每行两个数$u,v$，表示一条连接了$u,v$的树边。

### 输出格式

输出$n+1$个数，表示$k=0,k=1,k=2,...,k=n$的答案。

### 样例输入1

```
4
1 2
3 2
2 4
```

### 样例输出1

```
0 3 4 5 6 
```

### 样例输入2

```
1
```

### 样例输出2

```
0 0 
```

### 数据范围

对于$20\%$的数据，$n\leq 20$。

对于$40\%$的数据，$n\leq 100$。

对于$50\%$的数据，$n\leq 500$。

对于$100\%$的数据，$n\leq 5000$。

# 随机操作

## rand ( .cpp / .in / .out )

### 题目描述

有一个长度为$n$的数组$a_1,a_2,a_3,...,a_n$。和一个整数$v$。

你需要做以下操作$m$次：

- **等概率**选择一个$1$到$n$的整数$i$。
- 对于所有$j\geq i$，将$a_j$加上$v$。

你需要知道$\prod_{i=1}^n a_i$的期望值，对$10^9+7$取模。

### 输入格式

第一行三个整数，$n,m,v$。

第二行$n$个整数，$a_1,a_2,a_3,...,a_n$。

### 输出格式

一行表示答案。

### 样例输入1

```
2 2 5
2 2
```

### 样例输出1

```
84
```

### 样例输入2

```
5 7 9
9 9 8 2 4
```

### 样例输出2

```
975544726
```

### 数据范围

对于$20\%$的数据，$n,m\leq 5$。

对于$40\%$的数据，$n,m\leq 200$。

对于$60\%$的数据，$n\leq 200$。

对于$100\%$的数据，$n\leq 5000,1\leq m,v,a_i\leq 10^9$。

